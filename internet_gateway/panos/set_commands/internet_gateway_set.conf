# set of Gold-Silver-Bronze set commands
# single file with annotated sections

# Interface Management Profiles
# network profiles used on configured interfaces
set network profiles interface-management-profile "MSSP management untrust" ping yes
set network profiles interface-management-profile "MSSP management trust" https yes
set network profiles interface-management-profile "MSSP management trust" ssh yes
set network profiles interface-management-profile "MSSP management trust" ping yes
set network profiles interface-management-profile "MSSP management trust" response-pages yes


# OPTION-1: Internet Gateway with Untrust-Side DHCP Interface
set network interface ethernet {{ INTF_UNTRUST }} layer3 dhcp-client enable yes
set network interface ethernet {{ INTF_UNTRUST }} layer3 interface-management-profile "MSSP management untrust"
set network interface ethernet {{ INTF_TRUST }} layer3 ip {{ IP_12 }}
set network interface ethernet {{ INTF_TRUST }} layer3 interface-management-profile "MSSP management trust"
set network virtual-router default interface [ {{ INTF_UNTRUST }} {{ INTF_TRUST }} ]
set zone {{ ZONE_TRUST }} network layer3 {{ INTF_TRUST }}
set zone {{ ZONE_UNTRUST }} network layer3 {{ INTF_UNTRUST }}
set tag {{ ZONE_TRUST }} color color2
set tag {{ ZONE_UNTRUST }} color color1
set rulebase nat rules "Source NAT to Untrust" source-translation dynamic-ip-and-port interface-address interface {{ INTF_UNTRUST }}
set rulebase nat rules "Source NAT to Untrust" to {{ ZONE_UNTRUST }}
set rulebase nat rules "Source NAT to Untrust" from {{ ZONE_TRUST }}
set rulebase nat rules "Source NAT to Untrust" source any
set rulebase nat rules "Source NAT to Untrust" destination any
set rulebase nat rules "Source NAT to Untrust" service any

# Configure DHCP server for trust network - DHCP Dynamic Untrust Interface
# optional configuration is DHCP server used in the firewall
set network dhcp interface {{ INTF_TRUST }} server ip-pool {{ DHCP_POOL }}
set network dhcp interface {{ INTF_TRUST }} server mode auto
set network dhcp interface {{ INTF_TRUST }} server option inheritance source {{ INTF_UNTRUST }}
set network dhcp interface {{ INTF_TRUST }} server option dns primary inherited
set network dhcp interface {{ INTF_TRUST }} server option dns secondary inherited
set network dhcp interface {{ INTF_TRUST }} server option lease unlimited 
set network dhcp interface {{ INTF_TRUST }} server option gateway {{ DHCP_DG }}
set network dhcp interface {{ INTF_TRUST }} server option subnet-mask {{ DHCP_MASK }}


# OPTION-2: STATIC UNTRUST INTERFACE CONFIGURATION - see below for DHCP client untrust interface
set network interface ethernet {{ INTF_UNTRUST }} layer3 ip {{ IP_11 }}
set network interface ethernet {{ INTF_UNTRUST }} layer3 interface-management-profile "MSSP management untrust"
set network interface ethernet {{ INTF_TRUST }} layer3 ip {{ IP_12 }}
set network interface ethernet {{ INTF_TRUST }} layer3 interface-management-profile "MSSP management trust"
set network virtual-router default interface [ {{ INTF_UNTRUST }} {{ INTF_TRUST }} ]
set network virtual-router default routing-table ip static-route default nexthop ip-address {{ ROUTING_DG }}
set network virtual-router default routing-table ip static-route default interface {{ INTF_UNTRUST }}
set network virtual-router default routing-table ip static-route default destination 0.0.0.0/0
set zone {{ ZONE_TRUST }} network layer3 {{ INTF_TRUST }}
set zone {{ ZONE_UNTRUST }} network layer3 {{ INTF_TRUST }}
set tag {{ ZONE_TRUST }} color color2
set tag {{ ZONE_UNTRUST }} color color1
set rulebase nat rules "Source NAT to Untrust" source-translation dynamic-ip-and-port interface-address interface {{ INTF_UNTRUST }}
set rulebase nat rules "Source NAT to Untrust" source-translation dynamic-ip-and-port interface-address ip {{ IP_11 }}
set rulebase nat rules "Source NAT to Untrust" to {{ ZONE_UNTRUST }}
set rulebase nat rules "Source NAT to Untrust" from {{ ZONE_TRUST }}
set rulebase nat rules "Source NAT to Untrust" source any
set rulebase nat rules "Source NAT to Untrust" destination any
set rulebase nat rules "Source NAT to Untrust" service any


# Configure DHCP server for trust network - Static Untrust Interface - no Inheritance
# optional based DHCP server that requires static DNS configuration
set network dhcp interface {{ INTF_TRUST }} server ip-pool {{ DHCP_POOL }}
set network dhcp interface {{ INTF_TRUST }} server mode auto
set network dhcp interface {{ INTF_TRUST }} server option dns primary {{ DNS_1 }}
set network dhcp interface {{ INTF_TRUST }} server option dns secondary {{ DNS_2 }}
set network dhcp interface {{ INTF_TRUST }} server option lease unlimited 
set network dhcp interface {{ INTF_TRUST }} server option gateway {{ ROUTING_DG }}
set network dhcp interface {{ INTF_TRUST }} server option subnet-mask {{ DHCP_MASK }}


# Configure Service route to use Loopback instead of management interface for device-originating traffic
# optional if management interface not used for dynamic updates and other services
set network interface loopback units {{ SVC_ROUTE_INTF }}  ip  {{ SVC_ROUTE_IP }}
set deviceconfig system route service autofocus source address {{ SVC_ROUTE_IP }}
set deviceconfig system route service autofocus source interface {{ SVC_ROUTE_INTF }}
set deviceconfig system route service dns source address {{ SVC_ROUTE_IP }}
set deviceconfig system route service dns source interface {{ SVC_ROUTE_INTF }}
set deviceconfig system route service ntp source address {{ SVC_ROUTE_IP }}
set deviceconfig system route service ntp source interface {{ SVC_ROUTE_INTF }}
set deviceconfig system route service paloalto-networks-services source address {{ SVC_ROUTE_IP }}
set deviceconfig system route service paloalto-networks-services source interface {{ SVC_ROUTE_INTF }}
set deviceconfig system route service url-updates source address {{ SVC_ROUTE_IP }}
set deviceconfig system route service url-updates source interface {{ SVC_ROUTE_INTF }}
set deviceconfig system route service edl-updates source address {{ SVC_ROUTE_IP }}
set deviceconfig system route service edl-updates source interface {{ SVC_ROUTE_INTF }}
set deviceconfig system route service crl-status source address {{ SVC_ROUTE_IP }}
set deviceconfig system route service crl-status source interface {{ SVC_ROUTE_INTF }}


# General Use Tags for MSSP GSB
set tag Gold color color15
set tag Silver color color11
set tag Bronze color color5
set tag {{ ZONE_UNTRUST }} color color1
set tag {{ ZONE_TRUST }} color color13


# Gold specific objects and profile group based on URL category = unknown
set profile-group Outbound-Unknown-URL file-blocking strict
set profile-group Outbound-Unknown-URL spyware Outbound-AS
set profile-group Outbound-Unknown-URL virus Outbound-AV
set profile-group Outbound-Unknown-URL vulnerability Outbound-VP
set profile-group Outbound-Unknown-URL wildfire-analysis Outbound-WF

# 3 sections below, one each for Gold, Silver, and Bronze based on set of rules to load

# Gold security rules as add-on to the Iron-Skillet baseline
set rulebase security rules No-log-ntp-syslog-traffic profile-setting group Outbound
set rulebase security rules No-log-ntp-syslog-traffic to {{ ZONE_UNTRUST }}
set rulebase security rules No-log-ntp-syslog-traffic from {{ ZONE_TRUST }}
set rulebase security rules No-log-ntp-syslog-traffic source any
set rulebase security rules No-log-ntp-syslog-traffic destination any
set rulebase security rules No-log-ntp-syslog-traffic source-user any
set rulebase security rules No-log-ntp-syslog-traffic category any
set rulebase security rules No-log-ntp-syslog-traffic application [ ntp syslog ]
set rulebase security rules No-log-ntp-syslog-traffic service application-default
set rulebase security rules No-log-ntp-syslog-traffic hip-profiles any
set rulebase security rules No-log-ntp-syslog-traffic action allow
set rulebase security rules No-log-ntp-syslog-traffic log-end no
set rulebase security rules No-log-ntp-syslog-traffic description "This rule prevents logging of low-risk well-known applications that are sourced from the device"
set rulebase security rules No-log-ntp-syslog-traffic tag Gold
set rulebase security rules block-quic to {{ ZONE_UNTRUST }}
set rulebase security rules block-quic from {{ ZONE_TRUST }}
set rulebase security rules block-quic source any
set rulebase security rules block-quic destination any
set rulebase security rules block-quic source-user any
set rulebase security rules block-quic category any
set rulebase security rules block-quic application quic
set rulebase security rules block-quic service application-default
set rulebase security rules block-quic hip-profiles any
set rulebase security rules block-quic action deny
set rulebase security rules block-quic description "blocks quic and forces use of standard ssl for web sessions to help capture url values of encrypted sessions"
set rulebase security rules block-quic tag Gold
set rulebase security rules block-quic log-end yes
set rulebase security rules block-quic log-setting default
set rulebase security rules MSSP-no-unknown-URL-xfer profile-setting group Outbound-unknownURL
set rulebase security rules MSSP-no-unknown-URL-xfer to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-no-unknown-URL-xfer from {{ ZONE_TRUST }}
set rulebase security rules MSSP-no-unknown-URL-xfer source any
set rulebase security rules MSSP-no-unknown-URL-xfer destination any
set rulebase security rules MSSP-no-unknown-URL-xfer source-user any
set rulebase security rules MSSP-no-unknown-URL-xfer category unknown
set rulebase security rules MSSP-no-unknown-URL-xfer application any
set rulebase security rules MSSP-no-unknown-URL-xfer service application-default
set rulebase security rules MSSP-no-unknown-URL-xfer hip-profiles any
set rulebase security rules MSSP-no-unknown-URL-xfer action allow
set rulebase security rules MSSP-no-unknown-URL-xfer log-end yes
set rulebase security rules MSSP-no-unknown-URL-xfer log-setting default
set rulebase security rules MSSP-no-unknown-URL-xfer tag Gold
set rulebase security rules MSSP-no-unknown-URL-xfer description "This rule prevents the download of WF supported and risky file types from unknown category URL's."
set rulebase security rules MSSP-allow-outbound to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-allow-outbound from {{ ZONE_TRUST }}
set rulebase security rules MSSP-allow-outbound source any
set rulebase security rules MSSP-allow-outbound destination any
set rulebase security rules MSSP-allow-outbound source-user any
set rulebase security rules MSSP-allow-outbound category any
set rulebase security rules MSSP-allow-outbound application any
set rulebase security rules MSSP-allow-outbound service application-default
set rulebase security rules MSSP-allow-outbound hip-profiles any
set rulebase security rules MSSP-allow-outbound action allow
set rulebase security rules MSSP-allow-outbound log-end yes
set rulebase security rules MSSP-allow-outbound log-setting default
set rulebase security rules MSSP-allow-outbound profile-setting group Outbound
set rulebase security rules MSSP-allow-outbound tag Gold
set rulebase security rules MSSP-allow-outbound description "This is a general rule to allow trust to untrust traffic. It uses application defaults to prevent applications from running on non-default undefined ports. This is part of the App-ID support in the firewall"
set rulebase security rules MSSP-non-def-SSL-ports to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-non-def-SSL-ports from {{ ZONE_TRUST }}
set rulebase security rules MSSP-non-def-SSL-ports source any
set rulebase security rules MSSP-non-def-SSL-ports destination any
set rulebase security rules MSSP-non-def-SSL-ports source-user any
set rulebase security rules MSSP-non-def-SSL-ports category any
set rulebase security rules MSSP-non-def-SSL-ports application ssl
set rulebase security rules MSSP-non-def-SSL-ports service any
set rulebase security rules MSSP-non-def-SSL-ports hip-profiles any
set rulebase security rules MSSP-non-def-SSL-ports action allow
set rulebase security rules MSSP-non-def-SSL-ports log-end yes
set rulebase security rules MSSP-non-def-SSL-ports log-setting default
set rulebase security rules MSSP-non-def-SSL-ports profile-setting group Outbound
set rulebase security rules MSSP-non-def-SSL-ports tag Gold
set rulebase security rules MSSP-non-def-SSL-ports description "This is a complement to the allow-outbound rule to ensure sessions can be established and the proper application determined. Once determined, the session will shift to the allow-outbound rule."
set rulebase security rules MSSP-non-def-web-ports to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-non-def-web-ports from {{ ZONE_TRUST }}
set rulebase security rules MSSP-non-def-web-ports source any
set rulebase security rules MSSP-non-def-web-ports destination any
set rulebase security rules MSSP-non-def-web-ports source-user any
set rulebase security rules MSSP-non-def-web-ports category any
set rulebase security rules MSSP-non-def-web-ports application web-browsing
set rulebase security rules MSSP-non-def-web-ports service any
set rulebase security rules MSSP-non-def-web-ports hip-profiles any
set rulebase security rules MSSP-non-def-web-ports action allow
set rulebase security rules MSSP-non-def-web-ports log-end yes
set rulebase security rules MSSP-non-def-web-ports log-setting default
set rulebase security rules MSSP-non-def-web-ports profile-setting group Outbound
set rulebase security rules MSSP-non-def-web-ports tag Gold
set rulebase security rules MSSP-non-def-web-ports description "Provide visibility for non-default web browsing applications. Will provide security profile coverage and will allow based if a non-default port for the application. VISIBILITY ONLY and not app evasion."
set rulebase security rules MSSP-find-non-def-apps to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-find-non-def-apps from {{ ZONE_TRUST }}
set rulebase security rules MSSP-find-non-def-apps source any
set rulebase security rules MSSP-find-non-def-apps destination any
set rulebase security rules MSSP-find-non-def-apps source-user any
set rulebase security rules MSSP-find-non-def-apps category any
set rulebase security rules MSSP-find-non-def-apps application any
set rulebase security rules MSSP-find-non-def-apps service any
set rulebase security rules MSSP-find-non-def-apps hip-profiles any
set rulebase security rules MSSP-find-non-def-apps action allow
set rulebase security rules MSSP-find-non-def-apps profile-setting group Outbound
set rulebase security rules MSSP-find-non-def-apps tag Gold
set rulebase security rules MSSP-find-non-def-apps description "This is a temporary safety net rule to find apps not on non-default ports. It still has the Gold security profile to look for threats, block bad URL's, and send files to WF."
set rulebase security rules MSSP-find-non-def-apps log-end yes
set rulebase security rules MSSP-find-non-def-apps log-setting default
set rulebase security rules MSSP-find-non-def-apps application any


# Silver security rules based on Iron-Skillet
# Although skillet has URL Filtering, the configuration will commit with a 'no Threat license' warning
set rulebase security rules No-log-ntp-syslog-traffic profile-setting group MSSP-Silver
set rulebase security rules No-log-ntp-syslog-traffic to {{ ZONE_UNTRUST }}
set rulebase security rules No-log-ntp-syslog-traffic  from {{ ZONE_TRUST }}
set rulebase security rules No-log-ntp-syslog-traffic source any
set rulebase security rules No-log-ntp-syslog-traffic destination any
set rulebase security rules No-log-ntp-syslog-traffic source-user any
set rulebase security rules No-log-ntp-syslog-traffic category any
set rulebase security rules No-log-ntp-syslog-traffic application [ ntp syslog ]
set rulebase security rules No-log-ntp-syslog-traffic service application-default
set rulebase security rules No-log-ntp-syslog-traffic hip-profiles any
set rulebase security rules No-log-ntp-syslog-traffic action allow
set rulebase security rules No-log-ntp-syslog-traffic log-end no
set rulebase security rules No-log-ntp-syslog-traffic description "This rule prevents logging of low-risk well-known applications that are sourced from the device"
set rulebase security rules No-log-ntp-syslog-traffic tag Silver
set rulebase security rules block-quic to {{ ZONE_UNTRUST }}
set rulebase security rules block-quic from {{ ZONE_TRUST }}
set rulebase security rules block-quic source any
set rulebase security rules block-quic destination any
set rulebase security rules block-quic source-user any
set rulebase security rules block-quic category any
set rulebase security rules block-quic application quic
set rulebase security rules block-quic service application-default
set rulebase security rules block-quic hip-profiles any
set rulebase security rules block-quic action deny
set rulebase security rules block-quic description "blocks quic and forces use of standard ssl for web sessions to help capture url values of encrypted sessions"
set rulebase security rules block-quic tag Silver
set rulebase security rules block-quic log-end yes
set rulebase security rules block-quic log-setting default
set rulebase security rules MSSP-allow-outbound to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-allow-outbound from {{ ZONE_TRUST }}
set rulebase security rules MSSP-allow-outbound source any
set rulebase security rules MSSP-allow-outbound destination any
set rulebase security rules MSSP-allow-outbound source-user any
set rulebase security rules MSSP-allow-outbound category any
set rulebase security rules MSSP-allow-outbound application any
set rulebase security rules MSSP-allow-outbound service application-default
set rulebase security rules MSSP-allow-outbound hip-profiles any
set rulebase security rules MSSP-allow-outbound action allow
set rulebase security rules MSSP-allow-outbound log-end yes
set rulebase security rules MSSP-allow-outbound log-setting default
set rulebase security rules MSSP-allow-outbound profile-setting group MSSP-Silver
set rulebase security rules MSSP-allow-outbound tag Silver
set rulebase security rules MSSP-allow-outbound description "This is a general rule to allow trust to untrust traffic. It uses application defaults to prevent applications from running on non-default undefined ports. This is part of the App-ID support in the firewall"
set rulebase security rules MSSP-non-def-SSL-ports to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-non-def-SSL-ports from {{ ZONE_TRUST }}
set rulebase security rules MSSP-non-def-SSL-ports source any
set rulebase security rules MSSP-non-def-SSL-ports destination any
set rulebase security rules MSSP-non-def-SSL-ports source-user any
set rulebase security rules MSSP-non-def-SSL-ports category any
set rulebase security rules MSSP-non-def-SSL-ports application ssl
set rulebase security rules MSSP-non-def-SSL-ports service any
set rulebase security rules MSSP-non-def-SSL-ports hip-profiles any
set rulebase security rules MSSP-non-def-SSL-ports action allow
set rulebase security rules MSSP-non-def-SSL-ports log-end yes
set rulebase security rules MSSP-non-def-SSL-ports log-setting default
set rulebase security rules MSSP-non-def-SSL-ports profile-setting group MSSP-Silver
set rulebase security rules MSSP-non-def-SSL-ports tag Silver
set rulebase security rules MSSP-non-def-SSL-ports description "This is a complement to the allow-outbound rule to ensure sessions can be established and the proper application determined. Once determined, the session will shift to the allow-outbound rule."
set rulebase security rules MSSP-non-def-web-ports to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-non-def-web-ports from {{ ZONE_TRUST }}
set rulebase security rules MSSP-non-def-web-ports source any
set rulebase security rules MSSP-non-def-web-ports destination any
set rulebase security rules MSSP-non-def-web-ports source-user any
set rulebase security rules MSSP-non-def-web-ports category any
set rulebase security rules MSSP-non-def-web-ports application web-browsing
set rulebase security rules MSSP-non-def-web-ports service any
set rulebase security rules MSSP-non-def-web-ports hip-profiles any
set rulebase security rules MSSP-non-def-web-ports action allow
set rulebase security rules MSSP-non-def-web-ports log-end yes
set rulebase security rules MSSP-non-def-web-ports log-setting default
set rulebase security rules MSSP-non-def-web-ports profile-setting group MSSP-Silver
set rulebase security rules MSSP-non-def-web-ports tag Silver
set rulebase security rules MSSP-non-def-web-ports description "Provide visibility for non-default web browsing applications. Will provide security profile coverage and will allow based if a non-default port for the application. VISIBILITY ONLY and not app evasion."
set rulebase security rules MSSP-find-non-def-apps to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-find-non-def-apps from {{ ZONE_TRUST }}
set rulebase security rules MSSP-find-non-def-apps source any
set rulebase security rules MSSP-find-non-def-apps destination any
set rulebase security rules MSSP-find-non-def-apps source-user any
set rulebase security rules MSSP-find-non-def-apps category any
set rulebase security rules MSSP-find-non-def-apps application any
set rulebase security rules MSSP-find-non-def-apps service any
set rulebase security rules MSSP-find-non-def-apps hip-profiles any
set rulebase security rules MSSP-find-non-def-apps action allow
set rulebase security rules MSSP-find-non-def-apps profile-setting group MSSP-Silver
set rulebase security rules MSSP-find-non-def-apps tag Silver
set rulebase security rules MSSP-find-non-def-apps description "This is a temporary safety net rule to find apps not on non-default ports. It still has the Silver security profile to look for threats, block bad URL's, and send files to WF."
set rulebase security rules MSSP-find-non-def-apps log-end yes
set rulebase security rules MSSP-find-non-def-apps log-setting default
set rulebase security rules MSSP-find-non-def-apps application any


# Bronze security rules based on Iron Skillet
# Although Bronze has no subscriptions the config will config with 'no license' warnings
set rulebase security rules No-log-ntp-syslog-traffic profile-setting group MSSP-Bronze
set rulebase security rules No-log-ntp-syslog-traffic to {{ ZONE_UNTRUST }}
set rulebase security rules No-log-ntp-syslog-traffic  from {{ ZONE_TRUST }}
set rulebase security rules No-log-ntp-syslog-traffic source any
set rulebase security rules No-log-ntp-syslog-traffic destination any
set rulebase security rules No-log-ntp-syslog-traffic source-user any
set rulebase security rules No-log-ntp-syslog-traffic category any
set rulebase security rules No-log-ntp-syslog-traffic application [ ntp syslog ]
set rulebase security rules No-log-ntp-syslog-traffic service application-default
set rulebase security rules No-log-ntp-syslog-traffic hip-profiles any
set rulebase security rules No-log-ntp-syslog-traffic action allow
set rulebase security rules No-log-ntp-syslog-traffic log-end no
set rulebase security rules No-log-ntp-syslog-traffic description "This rule prevents logging of low-risk well-known applications that are sourced from the device"
set rulebase security rules No-log-ntp-syslog-traffic tag Bronze
set rulebase security rules block-quic to {{ ZONE_UNTRUST }}
set rulebase security rules block-quic from {{ ZONE_TRUST }}
set rulebase security rules block-quic source any
set rulebase security rules block-quic destination any
set rulebase security rules block-quic source-user any
set rulebase security rules block-quic category any
set rulebase security rules block-quic application quic
set rulebase security rules block-quic service application-default
set rulebase security rules block-quic hip-profiles any
set rulebase security rules block-quic action deny
set rulebase security rules block-quic description "blocks quic and forces use of standard ssl for web sessions to help capture url values of encrypted sessions"
set rulebase security rules block-quic tag Bronze
set rulebase security rules block-quic log-end yes
set rulebase security rules block-quic log-setting default
set rulebase security rules MSSP-allow-outbound to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-allow-outbound from {{ ZONE_TRUST }}
set rulebase security rules MSSP-allow-outbound source any
set rulebase security rules MSSP-allow-outbound destination any
set rulebase security rules MSSP-allow-outbound source-user any
set rulebase security rules MSSP-allow-outbound category any
set rulebase security rules MSSP-allow-outbound application any
set rulebase security rules MSSP-allow-outbound service application-default
set rulebase security rules MSSP-allow-outbound hip-profiles any
set rulebase security rules MSSP-allow-outbound action allow
set rulebase security rules MSSP-allow-outbound log-end yes
set rulebase security rules MSSP-allow-outbound log-setting default
set rulebase security rules MSSP-allow-outbound profile-setting group MSSP-Bronze
set rulebase security rules MSSP-allow-outbound tag Bronze
set rulebase security rules MSSP-allow-outbound description "This is a general rule to allow trust to untrust traffic. It uses application defaults to prevent applications from running on non-default undefined ports. This is part of the App-ID support in the firewall"
set rulebase security rules MSSP-non-def-SSL-ports to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-non-def-SSL-ports from {{ ZONE_TRUST }}
set rulebase security rules MSSP-non-def-SSL-ports source any
set rulebase security rules MSSP-non-def-SSL-ports destination any
set rulebase security rules MSSP-non-def-SSL-ports source-user any
set rulebase security rules MSSP-non-def-SSL-ports category any
set rulebase security rules MSSP-non-def-SSL-ports application ssl
set rulebase security rules MSSP-non-def-SSL-ports service any
set rulebase security rules MSSP-non-def-SSL-ports hip-profiles any
set rulebase security rules MSSP-non-def-SSL-ports action allow
set rulebase security rules MSSP-non-def-SSL-ports log-end yes
set rulebase security rules MSSP-non-def-SSL-ports log-setting default
set rulebase security rules MSSP-non-def-SSL-ports profile-setting group MSSP-Bronze
set rulebase security rules MSSP-non-def-SSL-ports tag Bronze
set rulebase security rules MSSP-non-def-SSL-ports description "This is a complement to the allow-outbound rule to ensure sessions can be established and the proper application determined. Once determined, the session will shift to the allow-outbound rule."
set rulebase security rules MSSP-non-def-web-ports to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-non-def-web-ports from {{ ZONE_TRUST }}
set rulebase security rules MSSP-non-def-web-ports source any
set rulebase security rules MSSP-non-def-web-ports destination any
set rulebase security rules MSSP-non-def-web-ports source-user any
set rulebase security rules MSSP-non-def-web-ports category any
set rulebase security rules MSSP-non-def-web-ports application web-browsing
set rulebase security rules MSSP-non-def-web-ports service any
set rulebase security rules MSSP-non-def-web-ports hip-profiles any
set rulebase security rules MSSP-non-def-web-ports action allow
set rulebase security rules MSSP-non-def-web-ports log-end yes
set rulebase security rules MSSP-non-def-web-ports log-setting default
set rulebase security rules MSSP-non-def-web-ports profile-setting group MSSP-Bronze
set rulebase security rules MSSP-non-def-web-ports tag Bronze
set rulebase security rules MSSP-non-def-web-ports description "Provide visibility for non-default web browsing applications. Will provide security profile coverage and will allow based if a non-default port for the application. VISIBILITY ONLY and not app evasion."
set rulebase security rules MSSP-find-non-def-apps to {{ ZONE_UNTRUST }}
set rulebase security rules MSSP-find-non-def-apps from {{ ZONE_TRUST }}
set rulebase security rules MSSP-find-non-def-apps source any
set rulebase security rules MSSP-find-non-def-apps destination any
set rulebase security rules MSSP-find-non-def-apps source-user any
set rulebase security rules MSSP-find-non-def-apps category any
set rulebase security rules MSSP-find-non-def-apps application any
set rulebase security rules MSSP-find-non-def-apps service any
set rulebase security rules MSSP-find-non-def-apps hip-profiles any
set rulebase security rules MSSP-find-non-def-apps action allow
set rulebase security rules MSSP-find-non-def-apps profile-setting group MSSP-Bronze
set rulebase security rules MSSP-find-non-def-apps tag Bronze
set rulebase security rules MSSP-find-non-def-apps description "This is a temporary safety net rule to find apps not on non-default ports. It still has the Bronze security profile to look for threats, block bad URL's, and send files to WF."
set rulebase security rules MSSP-find-non-def-apps log-end yes
set rulebase security rules MSSP-find-non-def-apps log-setting default
set rulebase security rules MSSP-find-non-def-apps application any


